stages:
  - validate

validate_sboms:
  stage: validate
  image: python:3.11
  script:
    - pip install --upgrade pip
    - python validate_sbom.py
    - git config user.email "gitlab-bot@example.com"
    - git config user.name "GitLab Bot"
    - git add README.md
    - git commit -m "âœ… Auto SBOM check on new upload" || echo "No changes"
    - git push || echo "Nothing to push"
  only:
    changes:
      - SBOMs to be checked/*.json   # ðŸ‘ˆ Triggers only if SBOMs change
    refs:
      - main                         # ðŸ‘ˆ On the main branch
